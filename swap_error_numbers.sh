#! /bin/bash

if [ "x$2" == "x-r" ]; then
    sed -i 's/\(\(%[A-Za-z]:\?\)\+\) \(\[[0-9]\+\]\)/\3 \1/g' $1
    sed -i 's/\(\(%[A-Za-z]:\?\)* \(warning\|error\):\) \(\[[0-9]\+\]\)/\4 \1/g' $1
    sed -i 's/\(warning\|error\): \(\[[0-9]\+\]\)/\2 \1:/g' $1
else
    sed -i 's/\"\(\[[0-9]\+\]\)\s*\(warning\|error\):/\"\2: \1/g' $1
    sed -i 's/\"\(\[[0-9]\+\]\)\s*\(\(%[A-Za-z]:\?\)* \(warning\|error\):\)/\"\2 \1/g' $1
    sed -i 's/\"\(\[[0-9]\+\]\)\s*\(\(%[A-Za-z]:\?\)\+\) /\"\2 \1 /g' $1
fi;
